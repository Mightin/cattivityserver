<!DOCTYPE html>
<html>
<head>
    <title>Cattivity</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery.tipsy/1.0.2/jquery.tipsy.css" rel="stylesheet" type="text/css">

    <script type="text/javascript" src="javascripts/d3.min.js"></script>
    <script type="text/javascript" src="javascripts/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tipsy/1.0.2/jquery.tipsy.min.js"></script>
    <script>
        var phones = <%- JSON.stringify(dots.phones ) %>;
        var locations = <%- JSON.stringify(dots.locations) %>;

        function placeDots(){
            var svgContainer = d3.select(".floorplan-svg");

            // place phones as red rectangles
            svgContainer.selectAll()
                    .data(phones).enter()
                    .append("rect")
                    .attr("fill", "red")
                    .attr("width", 10)
                    .attr("height", 10)
                    .attr("x", function(e) { return e.x })
                    .attr("y", function(e) { return e.y });
            $('svg rect').tipsy({
                html: true,
                title: function() {
                    var e = this.__data__;
                    var tip = "Location: " + e.place + ", ID: " + e.id;
                    return tip;
                }
            });

            // place locations as blue circles
            svgContainer.selectAll()
                    .data(locations).enter()
                    .append("circle")
                    .attr("fill", "blue")
                    .attr("r", 10)
                    .attr("cx", function(d) { return d.x })
                    .attr("cy", function(d) { return d.y })
                    .classed("locations",true);
            $('svg circle').tipsy({
                html: true,
                title: function() {
                    var d = this.__data__;
                    var tip = "Location: " + d.place + ", ID: " + d.id + ", values: " + d.values;
                    return tip;
                }
            });
        }
    </script>
</head>
<body>
<% include ../partials/header %>

<div class="container" onload="placeDots()">
    <div class="jumbotron">
        <h1>Fingerprint</h1>
        <p>This is a map of the points in the apartment which we have fingerprinted. Hovering on a point shows the average RSSI-values for the 3 beacons.</p>
        <svg class="floorplan-svg" height="590" width="1000" style="background-image: url(images/floorplan.png)" onload="placeDots()">
        </svg>
    </div>
</div>
</body>
</html>